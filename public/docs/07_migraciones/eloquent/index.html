<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="es" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="/laravel/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/laravel/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/laravel/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/laravel/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/laravel/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/laravel/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/laravel/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/laravel/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/laravel/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/laravel/favicons/android-192x192.png" sizes="192x192">

<title>Eloquent | Laravel: Framework de php</title>
<meta name="description" content="Eloquent ORM en Laravel Eloquent ORM en Laravel ofrece una variedad de m√©todos para interactuar con la base de datos de forma eficiente y elegante. Aqu√≠ tienes un resumen escueto de algunos de los m√©todos m√°s comunes que puedes usar para consultas, inserciones, actualizaciones y borrados:
M√©todos para Consultas all(): Recupera una colecci√≥n con todos los registros del modelo. Cada √≠tem es un objeto del modelo ya ‚Äúhidratado‚Äù (con datos y m√©todos listos para usar). find($id): Encuentra un registro por su clave primaria. where(&#39;column&#39;, &#39;value&#39;): Aplica una condici√≥n SQL WHERE. whereNull(&#39;column&#39;): Filtra registros donde la columna es NULL. whereNotNull(&#39;column&#39;): Filtra registros donde la columna NO es NULL. orderBy(&#39;column&#39;, &#39;direction&#39;): Ordena los resultados. take($limit): Limita el n√∫mero de resultados. get(): Ejecuta la consulta y devuelve una colecci√≥n de modelos completamente hidratados (objetos Eloquent). Se aplica sobre un Query Builder. $users = User::where(&#39;active&#39;, 1)-&gt;get(); // Collection&lt;User&gt; M√©todos para Inserciones y Actualizaciones save(): Guarda un nuevo modelo o actualiza un modelo existente. create($attributes): Crea un nuevo registro con los atributos proporcionados. update($attributes): Actualiza un modelo con los atributos proporcionados. M√©todos para Borrados delete(): Elimina un modelo de la base de datos. destroy($ids): Elimina modelos por su clave primaria. softDeletes(): Hace un borrado suave (no elimina los registros de la base de datos, solo los marca como borrados). M√©todos avanzados con relaciones has(&#39;relation&#39;): Filtra los registros que tienen al menos una relaci√≥n. Family::has(&#39;cycles&#39;)-&gt;get(); whereHas(&#39;relation&#39;, function($query){ ... }): Igual que has(), pero permite a√±adir condiciones a la relaci√≥n. Family::whereHas(&#39;cycles&#39;, function($q) { $q-&gt;where(&#39;year&#39;, 2025); })-&gt;get(); orWhereHas(&#39;relation&#39;, function($query){ ... }): Igual que whereHas(), pero combina la condici√≥n usando OR.">

<meta property="og:url" content="https://web.infenlaces.com/laravel/docs/07_migraciones/eloquent/">
  <meta property="og:site_name" content="Laravel: Framework de php">
  <meta property="og:title" content="Eloquent">
  <meta property="og:description" content="Eloquent ORM en Laravel Eloquent ORM en Laravel ofrece una variedad de m√©todos para interactuar con la base de datos de forma eficiente y elegante. Aqu√≠ tienes un resumen escueto de algunos de los m√©todos m√°s comunes que puedes usar para consultas, inserciones, actualizaciones y borrados:
M√©todos para Consultas all(): Recupera una colecci√≥n con todos los registros del modelo. Cada √≠tem es un objeto del modelo ya ‚Äúhidratado‚Äù (con datos y m√©todos listos para usar). find($id): Encuentra un registro por su clave primaria. where(&#39;column&#39;, &#39;value&#39;): Aplica una condici√≥n SQL WHERE. whereNull(&#39;column&#39;): Filtra registros donde la columna es NULL. whereNotNull(&#39;column&#39;): Filtra registros donde la columna NO es NULL. orderBy(&#39;column&#39;, &#39;direction&#39;): Ordena los resultados. take($limit): Limita el n√∫mero de resultados. get(): Ejecuta la consulta y devuelve una colecci√≥n de modelos completamente hidratados (objetos Eloquent). Se aplica sobre un Query Builder. $users = User::where(&#39;active&#39;, 1)-&gt;get(); // Collection&lt;User&gt; M√©todos para Inserciones y Actualizaciones save(): Guarda un nuevo modelo o actualiza un modelo existente. create($attributes): Crea un nuevo registro con los atributos proporcionados. update($attributes): Actualiza un modelo con los atributos proporcionados. M√©todos para Borrados delete(): Elimina un modelo de la base de datos. destroy($ids): Elimina modelos por su clave primaria. softDeletes(): Hace un borrado suave (no elimina los registros de la base de datos, solo los marca como borrados). M√©todos avanzados con relaciones has(&#39;relation&#39;): Filtra los registros que tienen al menos una relaci√≥n. Family::has(&#39;cycles&#39;)-&gt;get(); whereHas(&#39;relation&#39;, function($query){ ... }): Igual que has(), pero permite a√±adir condiciones a la relaci√≥n. Family::whereHas(&#39;cycles&#39;, function($q) { $q-&gt;where(&#39;year&#39;, 2025); })-&gt;get(); orWhereHas(&#39;relation&#39;, function($query){ ... }): Igual que whereHas(), pero combina la condici√≥n usando OR.">
  <meta property="og:locale" content="es">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:published_time" content="2023-04-08T18:21:47+02:00">
    <meta property="article:modified_time" content="2023-04-08T18:21:47+02:00">

  <meta itemprop="name" content="Eloquent">
  <meta itemprop="description" content="Eloquent ORM en Laravel Eloquent ORM en Laravel ofrece una variedad de m√©todos para interactuar con la base de datos de forma eficiente y elegante. Aqu√≠ tienes un resumen escueto de algunos de los m√©todos m√°s comunes que puedes usar para consultas, inserciones, actualizaciones y borrados:
M√©todos para Consultas all(): Recupera una colecci√≥n con todos los registros del modelo. Cada √≠tem es un objeto del modelo ya ‚Äúhidratado‚Äù (con datos y m√©todos listos para usar). find($id): Encuentra un registro por su clave primaria. where(&#39;column&#39;, &#39;value&#39;): Aplica una condici√≥n SQL WHERE. whereNull(&#39;column&#39;): Filtra registros donde la columna es NULL. whereNotNull(&#39;column&#39;): Filtra registros donde la columna NO es NULL. orderBy(&#39;column&#39;, &#39;direction&#39;): Ordena los resultados. take($limit): Limita el n√∫mero de resultados. get(): Ejecuta la consulta y devuelve una colecci√≥n de modelos completamente hidratados (objetos Eloquent). Se aplica sobre un Query Builder. $users = User::where(&#39;active&#39;, 1)-&gt;get(); // Collection&lt;User&gt; M√©todos para Inserciones y Actualizaciones save(): Guarda un nuevo modelo o actualiza un modelo existente. create($attributes): Crea un nuevo registro con los atributos proporcionados. update($attributes): Actualiza un modelo con los atributos proporcionados. M√©todos para Borrados delete(): Elimina un modelo de la base de datos. destroy($ids): Elimina modelos por su clave primaria. softDeletes(): Hace un borrado suave (no elimina los registros de la base de datos, solo los marca como borrados). M√©todos avanzados con relaciones has(&#39;relation&#39;): Filtra los registros que tienen al menos una relaci√≥n. Family::has(&#39;cycles&#39;)-&gt;get(); whereHas(&#39;relation&#39;, function($query){ ... }): Igual que has(), pero permite a√±adir condiciones a la relaci√≥n. Family::whereHas(&#39;cycles&#39;, function($q) { $q-&gt;where(&#39;year&#39;, 2025); })-&gt;get(); orWhereHas(&#39;relation&#39;, function($query){ ... }): Igual que whereHas(), pero combina la condici√≥n usando OR.">
  <meta itemprop="datePublished" content="2023-04-08T18:21:47+02:00">
  <meta itemprop="dateModified" content="2023-04-08T18:21:47+02:00">
  <meta itemprop="wordCount" content="2966">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Eloquent">
  <meta name="twitter:description" content="Eloquent ORM en Laravel Eloquent ORM en Laravel ofrece una variedad de m√©todos para interactuar con la base de datos de forma eficiente y elegante. Aqu√≠ tienes un resumen escueto de algunos de los m√©todos m√°s comunes que puedes usar para consultas, inserciones, actualizaciones y borrados:
M√©todos para Consultas all(): Recupera una colecci√≥n con todos los registros del modelo. Cada √≠tem es un objeto del modelo ya ‚Äúhidratado‚Äù (con datos y m√©todos listos para usar). find($id): Encuentra un registro por su clave primaria. where(&#39;column&#39;, &#39;value&#39;): Aplica una condici√≥n SQL WHERE. whereNull(&#39;column&#39;): Filtra registros donde la columna es NULL. whereNotNull(&#39;column&#39;): Filtra registros donde la columna NO es NULL. orderBy(&#39;column&#39;, &#39;direction&#39;): Ordena los resultados. take($limit): Limita el n√∫mero de resultados. get(): Ejecuta la consulta y devuelve una colecci√≥n de modelos completamente hidratados (objetos Eloquent). Se aplica sobre un Query Builder. $users = User::where(&#39;active&#39;, 1)-&gt;get(); // Collection&lt;User&gt; M√©todos para Inserciones y Actualizaciones save(): Guarda un nuevo modelo o actualiza un modelo existente. create($attributes): Crea un nuevo registro con los atributos proporcionados. update($attributes): Actualiza un modelo con los atributos proporcionados. M√©todos para Borrados delete(): Elimina un modelo de la base de datos. destroy($ids): Elimina modelos por su clave primaria. softDeletes(): Hace un borrado suave (no elimina los registros de la base de datos, solo los marca como borrados). M√©todos avanzados con relaciones has(&#39;relation&#39;): Filtra los registros que tienen al menos una relaci√≥n. Family::has(&#39;cycles&#39;)-&gt;get(); whereHas(&#39;relation&#39;, function($query){ ... }): Igual que has(), pero permite a√±adir condiciones a la relaci√≥n. Family::whereHas(&#39;cycles&#39;, function($q) { $q-&gt;where(&#39;year&#39;, 2025); })-&gt;get(); orWhereHas(&#39;relation&#39;, function($query){ ... }): Igual que whereHas(), pero combina la condici√≥n usando OR.">


<link rel="preload" href="/laravel/scss/main.min.f08d3ee4c2260e45bc83dcd9b8fb5edb2d493ec4ff88d5536efe7bcddf062080.css" as="style"><link href="/laravel/scss/main.min.f08d3ee4c2260e45bc83dcd9b8fb5edb2d493ec4ff88d5536efe7bcddf062080.css" rel="stylesheet">
<script
  src="https://code.jquery.com/jquery-3.7.1.min.js"
  integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
  crossorigin="anonymous"></script>

  </head>
  <body class="td-page">
    <header>
      <nav class="td-navbar js-navbar-scroll "  data-bs-theme="dark">
<div class="container-fluid flex-column flex-md-row ">
  <a class="navbar-brand" href="/laravel/"><span class="navbar-brand__logo navbar-logo">
    <img src="/laravel/images/logo.png" alt="Logo" width="150" height="auto" />
    </span><span class="navbar-brand__name">Laravel: Framework de php</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link active" href="/laravel/docs/"><span>Laravel</span></a>
      </li>
      <li class="nav-item dropdown d-none d-lg-block">
        <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Espa√±ol</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/laravel/fr/">Franc√©s</a></li>
    <li><a class="dropdown-item" href="/laravel/en/">English</a></li>
    </ul>
</div></li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    
  </div>
</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            <div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type="button" data-bs-toggle="collapse" data-bs-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="td-sidebar-nav collapse foldable-nav" id="td-section-nav">
    <div class="td-sidebar-nav__section nav-item dropdown d-block d-lg-none">
      <div class="dropdown">
  <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Espa√±ol</a>
  <ul class="dropdown-menu">
    <li><a class="dropdown-item" href="/laravel/fr/">Franc√©s</a></li>
    <li><a class="dropdown-item" href="/laravel/en/">English</a></li>
    </ul>
</div>
    </div>
    <ul class="td-sidebar-nav__section pe-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-laraveldocs-li">
  <a href="/laravel/docs/" title="Laravel Framework de php" class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-laraveldocs"><i class="fa-brands fa-laravel"></i><span class="">Laravel</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs01_introduccic3b3n-li">
  <input type="checkbox" id="m-laraveldocs01_introduccic3b3n-check"/>
  <label for="m-laraveldocs01_introduccic3b3n-check"><a href="/laravel/docs/01_introducci%C3%B3n/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs01_introduccic3b3n"><i class="fa-solid fa-info"></i><span class="">Introducci√≥n</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs02_instalacic3b3n-li">
  <input type="checkbox" id="m-laraveldocs02_instalacic3b3n-check"/>
  <label for="m-laraveldocs02_instalacic3b3n-check"><a href="/laravel/docs/02_instalaci%C3%B3n/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs02_instalacic3b3n"><i class="fa-solid fa-arrow-right"></i><span class="">Instalaci√≥n</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs03_rutas-li">
  <input type="checkbox" id="m-laraveldocs03_rutas-check"/>
  <label for="m-laraveldocs03_rutas-check"><a href="/laravel/docs/03_rutas/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs03_rutas"><i class="fa-solid fa-road"></i><span class="">Rutas en laravel</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs05_controlador-li">
  <input type="checkbox" id="m-laraveldocs05_controlador-check"/>
  <label for="m-laraveldocs05_controlador-check"><a href="/laravel/docs/05_controlador/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs05_controlador"><i class="fas fa-cogs"></i><span class="">Controlador</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-laraveldocs04_plantillas-li">
  <input type="checkbox" id="m-laraveldocs04_plantillas-check"/>
  <label for="m-laraveldocs04_plantillas-check"><a href="/laravel/docs/04_plantillas/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs04_plantillas"><i class="fa-brands fa-html5&#34;"></i><span class="">Plantillas en laravel</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs04_plantillas01_blade-li">
  <input type="checkbox" id="m-laraveldocs04_plantillas01_blade-check"/>
  <label for="m-laraveldocs04_plantillas01_blade-check"><a href="/laravel/docs/04_plantillas/01_blade/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs04_plantillas01_blade"><i class="fa-brands fa-html5"></i><span class="">Plantillas en laravel</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs04_plantillas02_creandodisec3b1o-li">
  <input type="checkbox" id="m-laraveldocs04_plantillas02_creandodisec3b1o-check"/>
  <label for="m-laraveldocs04_plantillas02_creandodisec3b1o-check"><a href="/laravel/docs/04_plantillas/02_creandodise%C3%B1o/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs04_plantillas02_creandodisec3b1o"><i class="fa-solid fa-layer-group"></i><span class="">Dise√±ando el layout</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs04_plantillas03_componentes-li">
  <input type="checkbox" id="m-laraveldocs04_plantillas03_componentes-check"/>
  <label for="m-laraveldocs04_plantillas03_componentes-check"><a href="/laravel/docs/04_plantillas/03_componentes/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs04_plantillas03_componentes"><i class="fa-regular fa-window-restore"></i><span class="">Componentes </span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-laraveldocs05_multilenguaje-li">
  <input type="checkbox" id="m-laraveldocs05_multilenguaje-check"/>
  <label for="m-laraveldocs05_multilenguaje-check"><a href="/laravel/docs/05_multilenguaje/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs05_multilenguaje"><span class="">Multilenguaje</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs05_multilenguajeplugin_busqueda-li">
  <input type="checkbox" id="m-laraveldocs05_multilenguajeplugin_busqueda-check"/>
  <label for="m-laraveldocs05_multilenguajeplugin_busqueda-check"><a href="/laravel/docs/05_multilenguaje/plugin_busqueda/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-laraveldocs05_multilenguajeplugin_busqueda"><i class="fa-solid fa-language"></i><span class="">Extracci√≥n de texto</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs60_collection-li">
  <input type="checkbox" id="m-laraveldocs60_collection-check"/>
  <label for="m-laraveldocs60_collection-check"><a href="/laravel/docs/60_collection/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs60_collection"><span class="">Collection en Laravel</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-laraveldocs06_autenticacion-li">
  <input type="checkbox" id="m-laraveldocs06_autenticacion-check"/>
  <label for="m-laraveldocs06_autenticacion-check"><a href="/laravel/docs/06_autenticacion/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs06_autenticacion"><i class="fa-solid fa-sitemap"></i><span class="">Autenticaci√≥n</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs06_autenticacionbreeze-li">
  <input type="checkbox" id="m-laraveldocs06_autenticacionbreeze-check"/>
  <label for="m-laraveldocs06_autenticacionbreeze-check"><a href="/laravel/docs/06_autenticacion/breeze/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs06_autenticacionbreeze"><i class="fa-solid fa-sitemap"></i><span class="">Instalaci√≥n</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs70_laravel_idea-li">
  <input type="checkbox" id="m-laraveldocs70_laravel_idea-check"/>
  <label for="m-laraveldocs70_laravel_idea-check"><a href="/laravel/docs/70_laravel_idea/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs70_laravel_idea"><span class="">Laravel Idea</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-laraveldocs07_migraciones-li">
  <input type="checkbox" id="m-laraveldocs07_migraciones-check" checked/>
  <label for="m-laraveldocs07_migraciones-check"><a href="/laravel/docs/07_migraciones/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs07_migraciones"><i class="fa-solid fa-database"></i><span class="">Migracioens</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-laraveldocs07_migracioneseloquent-li">
  <input type="checkbox" id="m-laraveldocs07_migracioneseloquent-check" checked/>
  <label for="m-laraveldocs07_migracioneseloquent-check"><a href="/laravel/docs/07_migraciones/eloquent/" class="align-left ps-0  active td-sidebar-link td-sidebar-link__page" id="m-laraveldocs07_migracioneseloquent"><i class="fa-solid fa-database"></i><span class="td-sidebar-nav-active-item">Eloquent</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs07_migracionessql_to_eloquent-li">
  <input type="checkbox" id="m-laraveldocs07_migracionessql_to_eloquent-check"/>
  <label for="m-laraveldocs07_migracionessql_to_eloquent-check"><a href="/laravel/docs/07_migraciones/sql_to_eloquent/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-laraveldocs07_migracionessql_to_eloquent"><i class="fa-solid fa-database"></i><span class="">SQL vs Eloquent</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-laraveldocs100_anexos-li">
  <input type="checkbox" id="m-laraveldocs100_anexos-check"/>
  <label for="m-laraveldocs100_anexos-check"><a href="/laravel/docs/100_anexos/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs100_anexos"><span class="">Anexos</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs100_anexosbootstrap-li">
  <input type="checkbox" id="m-laraveldocs100_anexosbootstrap-check"/>
  <label for="m-laraveldocs100_anexosbootstrap-check"><a href="/laravel/docs/100_anexos/bootstrap/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs100_anexosbootstrap"><span class="">app.php</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-laraveldocs10_api-li">
  <input type="checkbox" id="m-laraveldocs10_api-check"/>
  <label for="m-laraveldocs10_api-check"><a href="/laravel/docs/10_api/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs10_api"><i class="fas fa-code"></i><span class="">Creando un api</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs10_api1instalacion-li">
  <input type="checkbox" id="m-laraveldocs10_api1instalacion-check"/>
  <label for="m-laraveldocs10_api1instalacion-check"><a href="/laravel/docs/10_api/1.instalacion/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs10_api1instalacion"><span class="">01_Introducci√≥n y 20_rutas</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs10_api2visiongeneral-li">
  <input type="checkbox" id="m-laraveldocs10_api2visiongeneral-check"/>
  <label for="m-laraveldocs10_api2visiongeneral-check"><a href="/laravel/docs/10_api/2.visiongeneral/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs10_api2visiongeneral"><span class="">Controlador</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs10_api3la-vista-li">
  <input type="checkbox" id="m-laraveldocs10_api3la-vista-check"/>
  <label for="m-laraveldocs10_api3la-vista-check"><a href="/laravel/docs/10_api/3.la-vista/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs10_api3la-vista"><span class="">3.La Vista unitarios</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs10_api4-swagger-li">
  <input type="checkbox" id="m-laraveldocs10_api4-swagger-check"/>
  <label for="m-laraveldocs10_api4-swagger-check"><a href="/laravel/docs/10_api/4.-swagger/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-laraveldocs10_api4-swagger"><span class="">swagger</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs11_roles-li">
  <input type="checkbox" id="m-laraveldocs11_roles-check"/>
  <label for="m-laraveldocs11_roles-check"><a href="/laravel/docs/11_roles/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs11_roles"><i class="fa-brands fa-critical-role"></i><span class="">Roles</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-laraveldocs999_cheatseet-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseet-check"/>
  <label for="m-laraveldocs999_cheatseet-check"><a href="/laravel/docs/999_cheatseet/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs999_cheatseet"><span class="">Cheat Sheet</span></a></label>
  
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-laraveldocs999_cheatseethelper-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseethelper-check"/>
  <label for="m-laraveldocs999_cheatseethelper-check"><a href="/laravel/docs/999_cheatseet/helper/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs999_cheatseethelper"><span class="">Helper en Laravel</span></a></label>
  
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs999_cheatseethelper10_vistas-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseethelper10_vistas-check"/>
  <label for="m-laraveldocs999_cheatseethelper10_vistas-check"><a href="/laravel/docs/999_cheatseet/helper/10_vistas/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs999_cheatseethelper10_vistas"><span class="">Vistas</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs999_cheatseethelper20_rutas-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseethelper20_rutas-check"/>
  <label for="m-laraveldocs999_cheatseethelper20_rutas-check"><a href="/laravel/docs/999_cheatseet/helper/20_rutas/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs999_cheatseethelper20_rutas"><span class="">Rutas</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs999_cheatseethelper30_request-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseethelper30_request-check"/>
  <label for="m-laraveldocs999_cheatseethelper30_request-check"><a href="/laravel/docs/999_cheatseet/helper/30_request/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs999_cheatseethelper30_request"><span class="">Request en Laravel</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs999_cheatseetartisan-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseetartisan-check"/>
  <label for="m-laraveldocs999_cheatseetartisan-check"><a href="/laravel/docs/999_cheatseet/artisan/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs999_cheatseetartisan"><span class="">Artisan (CLI)</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs999_cheatseetblade-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseetblade-check"/>
  <label for="m-laraveldocs999_cheatseetblade-check"><a href="/laravel/docs/999_cheatseet/blade/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs999_cheatseetblade"><span class="">Directivas Blade</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs999_cheatseetcarbon-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseetcarbon-check"/>
  <label for="m-laraveldocs999_cheatseetcarbon-check"><a href="/laravel/docs/999_cheatseet/carbon/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs999_cheatseetcarbon"><span class="">Carbon (fechas</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-laraveldocs999_cheatseet04_despliegue-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseet04_despliegue-check"/>
  <label for="m-laraveldocs999_cheatseet04_despliegue-check"><a href="/laravel/docs/999_cheatseet/04_despliegue/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs999_cheatseet04_despliegue"><span class="">Desplegar en hosgint</span></a></label>
  
  <ul class="ul-3 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs999_cheatseet04_desplieguerutas-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseet04_desplieguerutas-check"/>
  <label for="m-laraveldocs999_cheatseet04_desplieguerutas-check"><a href="/laravel/docs/999_cheatseet/04_despliegue/rutas/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs999_cheatseet04_desplieguerutas"><span class="">Rutas</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs999_cheatseet04_desplieguevistas-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseet04_desplieguevistas-check"/>
  <label for="m-laraveldocs999_cheatseet04_desplieguevistas-check"><a href="/laravel/docs/999_cheatseet/04_despliegue/vistas/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs999_cheatseet04_desplieguevistas"><span class="">Vistas</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs999_cheatseet07_database-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseet07_database-check"/>
  <label for="m-laraveldocs999_cheatseet07_database-check"><a href="/laravel/docs/999_cheatseet/07_database/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs999_cheatseet07_database"><span class="">Desplegar en hosgint</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs999_cheatseet05_filefacade-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseet05_filefacade-check"/>
  <label for="m-laraveldocs999_cheatseet05_filefacade-check"><a href="/laravel/docs/999_cheatseet/05_filefacade/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-laraveldocs999_cheatseet05_filefacade"><span class="">Laravel: Uso de la Facade File</span></a></label>
  
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs999_cheatseet06_authfortity-li">
  <input type="checkbox" id="m-laraveldocs999_cheatseet06_authfortity-check"/>
  <label for="m-laraveldocs999_cheatseet06_authfortity-check"><a href="/laravel/docs/999_cheatseet/06_authfortity/" class="align-left ps-0  td-sidebar-link td-sidebar-link__page" id="m-laraveldocs999_cheatseet06_authfortity"><span class="">Laravel: Uso de la Facade File</span></a></label>
  
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-laraveldocs1010_shepherd-li">
  <input type="checkbox" id="m-laraveldocs1010_shepherd-check"/>
  <label for="m-laraveldocs1010_shepherd-check"><a href="/laravel/docs/1010_shepherd/" class="align-left ps-0  td-sidebar-link td-sidebar-link__section" id="m-laraveldocs1010_shepherd"><span class="">Controlar componentes Vue desde Shepherd</span></a></label>
  
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            <div class="td-page-meta ms-2 pb-1 pt-2 mb-0">

</div>

            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#m√©todos-para-consultas">M√©todos para Consultas</a></li>
    <li><a href="#m√©todos-para-inserciones-y-actualizaciones">M√©todos para Inserciones y Actualizaciones</a></li>
    <li><a href="#m√©todos-para-borrados">M√©todos para Borrados</a></li>
  </ul>

  <ul>
    <li><a href="#explicaci√≥n-de-withcount">Explicaci√≥n de <code>withCount</code></a>
      <ul>
        <li><a href="#alias-para-la-columna-con-el-conteo">Alias para la columna con el conteo</a></li>
      </ul>
    </li>
    <li><a href="#-diferencia-entre-has-y-wherehas-en-eloquent">‚úÖ Diferencia entre <code>has</code> y <code>whereHas</code> en Eloquent</a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#-ejemplo">‚úè Ejemplo:</a></li>
        <li><a href="#-tabla-resumen">üìå Tabla resumen:</a></li>
      </ul>
    </li>
    <li><a href="#m√©todos-para-transformaci√≥n-y-extracci√≥n-de-datos">M√©todos para transformaci√≥n y extracci√≥n de datos</a></li>
    <li><a href="#m√©todos-para-consultas-1">M√©todos para Consultas</a></li>
    <li><a href="#m√©todos-para-inserciones-y-actualizaciones-1">M√©todos para Inserciones y Actualizaciones</a></li>
    <li><a href="#ejemplos">Ejemplos</a></li>
    <li><a href="#otros-m√©todos-√∫tiles">Otros M√©todos √ötiles</a></li>
    <li><a href="#-campos-for√°neos-y-claves-externas-en-laravel">üîó Campos for√°neos y claves externas en Laravel</a></li>
    <li><a href="#-cu√°ndo-pasar-el-nombre-de-la-tabla-a-constrained">üîó ¬øCu√°ndo pasar el nombre de la tabla a <code>constrained()</code>?</a></li>
  </ul>

  <ul>
    <li><a href="#-m√©todos-para-definir-relaciones-entre-modelos-en-laravel">üõ†Ô∏è M√©todos para definir relaciones entre modelos en Laravel</a></li>
    <li><a href="#-c√≥mo-definir-una-relaci√≥n-muchos-a-muchos">‚úÖ C√≥mo definir una relaci√≥n muchos a muchos</a></li>
    <li><a href="#-tabla-pivote-nombre-y-convenci√≥n">üìå Tabla pivote: nombre y convenci√≥n</a></li>
    <li><a href="#-cu√°ndo-crear-la-tabla-pivote-expl√≠citamente">üß± Cu√°ndo crear la tabla pivote expl√≠citamente</a></li>
    <li><a href="#-ejemplo-de-migraci√≥n-de-tabla-pivote-con-columna-extra">üìÑ Ejemplo de migraci√≥n de tabla pivote con columna extra</a></li>
    <li><a href="#-acceder-a-los-campos-adicionales-de-la-tabla-pivote">üß© Acceder a los campos adicionales de la tabla pivote</a></li>
    <li><a href="#-diferencia-entre-hasmany-y-belongstomany">ü§î Diferencia entre <code>hasMany()</code> y <code>belongsToMany()</code></a></li>
    <li><a href="#-resumen-visual">üß© Resumen visual</a></li>
  </ul>
</nav>
      </div>
    
            <div class="taxonomy taxonomy-terms-cloud taxo-categories">
      <h5 class="taxonomy-title">Categories</h5>
      <ul class="taxonomy-terms">
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/categories/archivos/" data-taxonomy-term="archivos"><span class="taxonomy-label">Archivos</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/categories/auth/" data-taxonomy-term="auth"><span class="taxonomy-label">Auth</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/categories/facades/" data-taxonomy-term="facades"><span class="taxonomy-label">Facades</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/categories/filament/" data-taxonomy-term="filament"><span class="taxonomy-label">Filament</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/categories/fortity/" data-taxonomy-term="fortity"><span class="taxonomy-label">Fortity</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/categories/laravel/" data-taxonomy-term="laravel"><span class="taxonomy-label">Laravel</span><span class="taxonomy-count">6</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/categories/optimizaci%C3%B3n/" data-taxonomy-term="optimizaci%C3%B3n"><span class="taxonomy-label">Optimizaci√≥n</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/categories/panel/" data-taxonomy-term="panel"><span class="taxonomy-label">Panel</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/categories/p%C3%A1ginas/" data-taxonomy-term="p%C3%A1ginas"><span class="taxonomy-label">P√°ginas</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/categories/widgets/" data-taxonomy-term="widgets"><span class="taxonomy-label">Widgets</span><span class="taxonomy-count">1</span></a></li>
        </ul>
    </div>
  <div class="taxonomy taxonomy-terms-cloud taxo-tags">
      <h5 class="taxonomy-title">Tags</h5>
      <ul class="taxonomy-terms">
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/auth/" data-taxonomy-term="auth"><span class="taxonomy-label">Auth</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/axios/" data-taxonomy-term="axios"><span class="taxonomy-label">Axios</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/dashboard/" data-taxonomy-term="dashboard"><span class="taxonomy-label">Dashboard</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/facades/" data-taxonomy-term="facades"><span class="taxonomy-label">Facades</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/filament/" data-taxonomy-term="filament"><span class="taxonomy-label">Filament</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/file/" data-taxonomy-term="file"><span class="taxonomy-label">File</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/fortity/" data-taxonomy-term="fortity"><span class="taxonomy-label">Fortity</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/herramientas/" data-taxonomy-term="herramientas"><span class="taxonomy-label">Herramientas</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/inertia/" data-taxonomy-term="inertia"><span class="taxonomy-label">Inertia</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/laravel/" data-taxonomy-term="laravel"><span class="taxonomy-label">Laravel</span><span class="taxonomy-count">7</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/laravel/" data-taxonomy-term="laravel"><span class="taxonomy-label">Laravel&#39;</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/navegaci%C3%B3n/" data-taxonomy-term="navegaci%C3%B3n"><span class="taxonomy-label">Navegaci√≥n</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/panel/" data-taxonomy-term="panel"><span class="taxonomy-label">Panel</span><span class="taxonomy-count">4</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/performance/" data-taxonomy-term="performance"><span class="taxonomy-label">Performance</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/p%C3%A1ginas/" data-taxonomy-term="p%C3%A1ginas"><span class="taxonomy-label">P√°ginas</span><span class="taxonomy-count">1</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/vue/" data-taxonomy-term="vue"><span class="taxonomy-label">Vue</span><span class="taxonomy-count">3</span></a></li>
        <li><a class="taxonomy-term" href="https://web.infenlaces.com/laravel/tags/widgets/" data-taxonomy-term="widgets"><span class="taxonomy-label">Widgets</span><span class="taxonomy-count">1</span></a></li>
        </ul>
    </div>
  

          </aside>
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="/laravel/docs/">Laravel</a></li>
  <li class="breadcrumb-item">
    <a href="/laravel/docs/07_migraciones/">Migracioens</a></li>
  <li class="breadcrumb-item active" aria-current="page">
    Eloquent</li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>Eloquent</h1>
	
	<header class="article-meta">
		
</header>
	<h1 id="eloquent-orm-en-laravel">Eloquent ORM en Laravel</h1>
<p>Eloquent ORM en Laravel ofrece una variedad de m√©todos para interactuar con la base de datos de forma eficiente y elegante. Aqu√≠ tienes un resumen escueto de algunos de los m√©todos m√°s comunes que puedes usar para consultas, inserciones, actualizaciones y borrados:</p>
<h2 id="m√©todos-para-consultas">M√©todos para Consultas</h2>
<ul>
<li><code>all()</code>: Recupera una <strong>colecci√≥n</strong> con todos los registros del modelo. Cada √≠tem es un objeto del modelo ya ‚Äúhidratado‚Äù (con datos y m√©todos listos para usar).</li>
<li><code>find($id)</code>: Encuentra un registro por su clave primaria.</li>
<li><code>where('column', 'value')</code>: Aplica una condici√≥n SQL WHERE.</li>
<li><code>whereNull('column')</code>: Filtra registros donde la columna es NULL.</li>
<li><code>whereNotNull('column')</code>: Filtra registros donde la columna NO es NULL.</li>
<li><code>orderBy('column', 'direction')</code>: Ordena los resultados.</li>
<li><code>take($limit)</code>: Limita el n√∫mero de resultados.</li>
<li><code>get()</code>: Ejecuta la consulta y devuelve una <strong>colecci√≥n</strong> de modelos completamente hidratados (objetos Eloquent). Se aplica sobre un <strong>Query Builder</strong>.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#00688b">$users</span> = User::<span style="color:#658b00">where</span>(<span style="color:#cd5555">&#39;active&#39;</span>, <span style="color:#b452cd">1</span>)-&gt;<span style="color:#658b00">get</span>(); <span style="color:#228b22">// Collection&lt;User&gt;
</span></span></span></code></pre></div>
<h2 id="m√©todos-para-inserciones-y-actualizaciones">M√©todos para Inserciones y Actualizaciones</h2>
<ul>
<li><code>save()</code>: Guarda un nuevo modelo o actualiza un modelo existente.</li>
<li><code>create($attributes)</code>: Crea un nuevo registro con los atributos proporcionados.</li>
<li><code>update($attributes)</code>: Actualiza un modelo con los atributos proporcionados.</li>
</ul>
<h2 id="m√©todos-para-borrados">M√©todos para Borrados</h2>
<ul>
<li><code>delete()</code>: Elimina un modelo de la base de datos.</li>
<li><code>destroy($ids)</code>: Elimina modelos por su clave primaria.</li>
<li><code>softDeletes()</code>: Hace un borrado suave (no elimina los registros de la base de datos, solo los marca como borrados).</li>
</ul>
<h1 id="m√©todos-avanzados-con-relaciones">M√©todos avanzados con relaciones</h1>
<ul>
<li><code>has('relation')</code>: Filtra los registros que <strong>tienen al menos una</strong> relaci√≥n.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>Family::<span style="color:#658b00">has</span>(<span style="color:#cd5555">&#39;cycles&#39;</span>)-&gt;<span style="color:#658b00">get</span>();</span></span></code></pre></div>
<ul>
<li><code>whereHas('relation', function($query){ ... })</code>: Igual que <code>has()</code>, pero permite a√±adir condiciones a la relaci√≥n.</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>Family::<span style="color:#658b00">whereHas</span>(<span style="color:#cd5555">&#39;cycles&#39;</span>, <span style="color:#8b008b;font-weight:bold">function</span>(<span style="color:#00688b">$q</span>) {
</span></span><span style="display:flex;"><span><span style="color:#00688b">$q</span>-&gt;<span style="color:#658b00">where</span>(<span style="color:#cd5555">&#39;year&#39;</span>, <span style="color:#b452cd">2025</span>);
</span></span><span style="display:flex;"><span>})-&gt;<span style="color:#658b00">get</span>();</span></span></code></pre></div>
<ul>
<li>
<p><code>orWhereHas('relation', function($query){ ... })</code>: Igual que <code>whereHas()</code>, pero combina la condici√≥n usando <strong>OR</strong>.</p>
</li>
<li>
<p><code>doesntHave('relation')</code>: Filtra los registros que <strong>no tienen</strong> la relaci√≥n.</p>
</li>
<li>
<p><code>whereDoesntHave('relation', function($query){ ... })</code>: Filtra los registros cuya relaci√≥n <strong>no cumple</strong> la condici√≥n especificada.</p>
</li>
</ul>
<blockquote>
<blockquote>
<p>üí° Importante:</p></blockquote></blockquote>
<blockquote>
<blockquote>
<p>Todos estos m√©todos (has, whereHas, orWhereHas, doesntHave, whereDoesntHave) devuelven un devuelven un <strong>Query Builder</strong> y <strong>no ejecutan la consulta</strong>.
Para obtener la colecci√≥n de resultados, hay que ejecutar la consulta con m√©todos como:</p></blockquote></blockquote>
<blockquote>
<blockquote>
<ul>
<li>get() ‚Üí colecci√≥n de modelos.</li>
</ul></blockquote></blockquote>
<blockquote>
<blockquote>
<ul>
<li>first() ‚Üí primer modelo o null.</li>
</ul></blockquote></blockquote>
<blockquote>
<blockquote>
<ul>
<li>count() ‚Üí n√∫mero de resultadosüí° Tanto <code>has</code> como <code>whereHas</code>, <code>orWhereHas</code>, <code>doesntHave</code> y <code>whereDoesntHave</code></li>
</ul></blockquote></blockquote>
<ul>
<li><code>with('relation')</code>: Carga (eager loading) la relaci√≥n para evitar consultas N+1.</li>
<li><code>withCount('relation')</code>: A√±ade una columna extra con el n√∫mero de elementos de la relaci√≥n.</li>
<li><code>role('nombre_rol')</code>: A√±ade a la consulta un filtro para obtener solo los modelos que tengan asignado el rol indicado. Devuelve un query builder (no una colecci√≥n) sobre el que se pueden encadenar otros m√©todos como get(), first(), count(), etc.</li>
</ul>
<p>üí° Ejemplo:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>User::<span style="color:#658b00">role</span>(<span style="color:#cd5555">&#39;teacher&#39;</span>)-&gt;<span style="color:#658b00">get</span>(); <span style="color:#228b22">// Colecci√≥n de usuarios con el rol &#34;teacher&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>User::<span style="color:#658b00">role</span>(<span style="color:#cd5555">&#39;student&#39;</span>)-&gt;<span style="color:#658b00">count</span>(); <span style="color:#228b22">// N√∫mero de usuarios con el rol &#34;student&#34;
</span></span></span></code></pre></div>
<blockquote>
<p>como el objeto que retorna es un query builder, se puede ver el c√≥digo sql con el m√©todo toSql()</p></blockquote>
<h1 id="otros-m√©todos-importantes-e-interesantes-para-usar-en-eloquent">Otros m√©todos importantes e interesantes para usar en Eloquent</h1>
<p>Adem√°s del m√©todo <code>role()</code> que vimos antes, Eloquent tiene otros m√©todos muy √∫tiles para trabajar con consultas y modelos:</p>
<table>
  <thead>
      <tr>
          <th>M√©todo</th>
          <th>Descripci√≥n</th>
          <th>Retorno / Uso</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>toSql()</code></td>
          <td>Devuelve la consulta SQL generada por el query builder</td>
          <td>Cadena (string) con la consulta SQL</td>
      </tr>
      <tr>
          <td><code>get()</code></td>
          <td>Ejecuta la consulta y devuelve una colecci√≥n de modelos</td>
          <td><code>Collection</code> de modelos</td>
      </tr>
      <tr>
          <td><code>first()</code></td>
          <td>Devuelve el primer resultado o <code>null</code></td>
          <td>Modelo o <code>null</code></td>
      </tr>
      <tr>
          <td><code>pluck('campo')</code></td>
          <td>Obtiene una colecci√≥n con los valores de un campo espec√≠fico</td>
          <td><code>Collection</code> con valores simples</td>
      </tr>
      <tr>
          <td><code>count()</code></td>
          <td>Devuelve el n√∫mero total de registros</td>
          <td>Entero (int)</td>
      </tr>
      <tr>
          <td><code>paginate(n)</code></td>
          <td>Ejecuta la consulta paginada con <code>n</code> resultados por p√°gina</td>
          <td><code>LengthAwarePaginator</code></td>
      </tr>
      <tr>
          <td><code>where()</code></td>
          <td>A√±ade condiciones a la consulta</td>
          <td>Query Builder para encadenar m√°s m√©todos</td>
      </tr>
      <tr>
          <td><code>with('relacion')</code></td>
          <td>Carga relaciones para evitar consultas N+1</td>
          <td>Query Builder con eager loading</td>
      </tr>
      <tr>
          <td>`orderBy(&lsquo;campo&rsquo;, &lsquo;asc</td>
          <td>desc&rsquo;)`</td>
          <td>Ordena los resultados</td>
      </tr>
      <tr>
          <td><code>exists()</code></td>
          <td>Comprueba si existen registros que cumplen la consulta</td>
          <td>Booleano (<code>true</code> o <code>false</code>)</td>
      </tr>
      <tr>
          <td><code>select('campos')</code></td>
          <td>Especifica los campos que se quieren recuperar en la consulta</td>
          <td>Query Builder (permite encadenar m√°s m√©todos)</td>
      </tr>
      <tr>
          <td><code>addSelect('campos')</code></td>
          <td>A√±ade m√°s campos a la selecci√≥n sin eliminar los anteriores</td>
          <td>Query Builder</td>
      </tr>
      <tr>
          <td><code>distinct()</code></td>
          <td>Devuelve solo resultados √∫nicos (sin duplicados)</td>
          <td>Query Builder</td>
      </tr>
      <tr>
          <td><code>groupBy('campo')</code></td>
          <td>Agrupa resultados seg√∫n un campo</td>
          <td>Query Builder</td>
      </tr>
      <tr>
          <td><code>having()</code></td>
          <td>Condici√≥n para grupos despu√©s de un <code>groupBy()</code></td>
          <td>Query Builder</td>
      </tr>
      <tr>
          <td><code>limit(n)</code></td>
          <td>Limita el n√∫mero de resultados devueltos</td>
          <td>Query Builder</td>
      </tr>
      <tr>
          <td><code>offset(n)</code></td>
          <td>Desplaza el inicio de los resultados (para paginaci√≥n manual)</td>
          <td>Query Builder</td>
      </tr>
      <tr>
          <td><code>selectRaw('expresi√≥n SQL')</code></td>
          <td>Permite usar expresiones SQL en el select</td>
          <td>Query Builder</td>
      </tr>
      <tr>
          <td>`orderBy(&lsquo;campo&rsquo;, &lsquo;asc</td>
          <td>desc&rsquo;)`</td>
          <td>Ordena resultados</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="explicaci√≥n-de-withcount">Explicaci√≥n de <code>withCount</code></h2>
<ul>
<li>El m√©todo <code>withCount</code> se usa para obtener el <strong>n√∫mero de registros relacionados</strong> de forma eficiente, sin cargar toda la relaci√≥n.</li>
<li>El par√°metro que recibe debe ser el <strong>nombre del m√©todo de relaci√≥n definido en el modelo</strong>, no el nombre de la tabla en la base de datos.</li>
<li>Por ejemplo, si en el modelo <code>Cycle</code> tienes un m√©todo llamado <code>enrollments()</code> que define la relaci√≥n con las inscripciones, usar√°s:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>Cycle::<span style="color:#658b00">withCount</span>(<span style="color:#cd5555">&#39;enrollments&#39;</span>)-&gt;<span style="color:#658b00">get</span>();</span></span></code></pre></div>
<ul>
<li>Esto a√±adir√° autom√°ticamente un atributo <code>enrollments_count</code> a cada instancia de <code>Cycle</code> con el n√∫mero de inscripciones relacionadas.</li>
</ul>
<h3 id="alias-para-la-columna-con-el-conteo">Alias para la columna con el conteo</h3>
<ul>
<li>Si quieres cambiar el nombre de la columna generada por el conteo, puedes usar un alias con la sintaxis <code>as</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>Cycle::<span style="color:#658b00">withCount</span>(<span style="color:#cd5555">&#39;enrollments as total_alumnos&#39;</span>)-&gt;<span style="color:#658b00">get</span>();</span></span></code></pre></div>
<ul>
<li>Esto a√±adir√° un atributo llamado <code>total_alumnos</code> en lugar de <code>enrollments_count</code>.</li>
</ul>
<hr>
<h2 id="-diferencia-entre-has-y-wherehas-en-eloquent">‚úÖ Diferencia entre <code>has</code> y <code>whereHas</code> en Eloquent</h2>
<ul>
<li>
<p><code>has('relacion')</code><br>
Devuelve modelos que <strong>tienen al menos un registro relacionado</strong>.<br>
Solo comprueba la existencia.</p>
</li>
<li>
<p><code>whereHas('relacion')</code><br>
Funciona igual que <code>has</code>, pero <strong>permite a√±adir condiciones</strong> en un callback.</p>
</li>
</ul>
<p>Si no a√±ades condiciones, ambos devuelven exactamente el mismo resultado.</p>
<hr>
<h1 id="diferencia-entre-select-y-pluck-en-eloquent">Diferencia entre <code>select()</code> y <code>pluck()</code> en Eloquent</h1>
<table>
  <thead>
      <tr>
          <th>M√©todo</th>
          <th>Qu√© hace</th>
          <th>Resultado</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>select()</code></td>
          <td>Especifica los campos que quieres recuperar en la consulta SQL</td>
          <td>Devuelve una colecci√≥n de modelos con solo esos campos cargados (Collection de modelos)</td>
      </tr>
      <tr>
          <td><code>pluck()</code></td>
          <td>Obtiene directamente los valores de un campo espec√≠fico</td>
          <td>Devuelve una colecci√≥n simple con los valores del campo seleccionado (Collection de valores)</td>
      </tr>
  </tbody>
</table>
<h3 id="-ejemplo">‚úè Ejemplo:</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>Family::<span style="color:#658b00">has</span>(<span style="color:#cd5555">&#39;specializations.users&#39;</span>)-&gt;<span style="color:#658b00">pluck</span>(<span style="color:#cd5555">&#39;name&#39;</span>);
</span></span><span style="display:flex;"><span>Family::<span style="color:#658b00">whereHas</span>(<span style="color:#cd5555">&#39;specializations.users&#39;</span>)-&gt;<span style="color:#658b00">pluck</span>(<span style="color:#cd5555">&#39;name&#39;</span>);</span></span></code></pre></div>
<p>Ambos devuelven las familias que tienen al menos un usuario a trav√©s de sus especializaciones.</p>
<hr>
<h3 id="-tabla-resumen">üìå Tabla resumen:</h3>
<table>
  <thead>
      <tr>
          <th></th>
          <th><code>has()</code></th>
          <th><code>whereHas()</code></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Comprobar existencia</td>
          <td>‚úî</td>
          <td>‚úî</td>
      </tr>
      <tr>
          <td>A√±adir condiciones</td>
          <td>‚úñ</td>
          <td>‚úî</td>
      </tr>
      <tr>
          <td>Sin condiciones</td>
          <td>Mismo resultado</td>
          <td>Mismo resultado</td>
      </tr>
  </tbody>
</table>
<hr>
<p>‚úÖ <strong>Tip:</strong><br>
Usa <code>has</code> si solo necesitas saber si existen registros relacionados.<br>
Usa <code>whereHas</code> si adem√°s necesitas filtrar los registros relacionados por alguna condici√≥n.</p>
<h2 id="m√©todos-para-transformaci√≥n-y-extracci√≥n-de-datos">M√©todos para transformaci√≥n y extracci√≥n de datos</h2>
<ul>
<li><code>pluck('column')</code>: Obtiene directamente los valores de una columna como colecci√≥n.</li>
<li><code>value('column')</code>: Obtiene el valor de la columna en el primer registro.</li>
<li><code>toArray()</code>: Convierte el resultado a array.</li>
<li><code>toJson()</code>: Convierte el resultado a JSON.</li>
<li><code>chunk($cantidad, $callback)</code>: Procesa los resultados por partes.</li>
<li><code>dd()</code>: Dump &amp; Die, muestra el contenido y detiene la ejecuci√≥n.</li>
<li><code>dump()</code>: Igual que dd pero sin detener la ejecuci√≥n.</li>
</ul>
<h2 id="m√©todos-para-consultas-1">M√©todos para Consultas</h2>
<ul>
<li><code>all()</code>: Recupera todas las filas de la tabla.</li>
<li><code>find($id)</code>: Encuentra un registro por su clave primaria.</li>
<li><code>where('column', 'value')</code>: Aplica una condici√≥n SQL WHERE.</li>
<li><code>whereNull('column')</code>: Filtra registros donde la columna es NULL.</li>
<li><code>whereNotNull('column')</code>: Filtra registros donde la columna NO es NULL.</li>
<li><code>orderBy('column', 'direction')</code>: Ordena los resultados.</li>
<li><code>take($limit)</code>: Limita el n√∫mero de resultados.</li>
<li><code>get()</code>: Obtiene los resultados de una consulta.</li>
</ul>
<h2 id="m√©todos-para-inserciones-y-actualizaciones-1">M√©todos para Inserciones y Actualizaciones</h2>
<ul>
<li><code>save()</code>: Guarda un nuevo modelo o actualiza un modelo existente.</li>
<li><code>create($attributes)</code>: Crea un nuevo registro con los atributos proporcionados.</li>
<li><code>update($attributes)</code>: Actualiza un modelo con los atributos proporcionados.</li>
</ul>
<h2 id="ejemplos">Ejemplos</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>User::<span style="color:#658b00">pluck</span>(<span style="color:#cd5555">&#39;email&#39;</span>);</span></span></code></pre></div>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>User::<span style="color:#658b00">whereHas</span>(<span style="color:#cd5555">&#39;roles&#39;</span>, fn(<span style="color:#00688b">$q</span>) =&gt; <span style="color:#00688b">$q</span>-&gt;<span style="color:#658b00">where</span>(<span style="color:#cd5555">&#39;name&#39;</span>, <span style="color:#cd5555">&#39;admin&#39;</span>))-&gt;<span style="color:#658b00">exists</span>();</span></span></code></pre></div>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>User::<span style="color:#658b00">count</span>();</span></span></code></pre></div>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>User::<span style="color:#658b00">with</span>(<span style="color:#cd5555">&#39;specialization.family&#39;</span>)-&gt;<span style="color:#658b00">get</span>();</span></span></code></pre></div>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>User::<span style="color:#658b00">chunk</span>(<span style="color:#b452cd">100</span>, <span style="color:#8b008b;font-weight:bold">function</span>(<span style="color:#00688b">$users</span>) {
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">foreach</span> (<span style="color:#00688b">$users</span> <span style="color:#8b008b;font-weight:bold">as</span> <span style="color:#00688b">$user</span>) {
</span></span><span style="display:flex;"><span><span style="color:#228b22">// procesar
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>}
</span></span><span style="display:flex;"><span>});</span></span></code></pre></div>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#00688b">$totalSalaries</span> = User::<span style="color:#658b00">sum</span>(<span style="color:#cd5555">&#39;salary&#39;</span>);</span></span></code></pre></div>
<h2 id="otros-m√©todos-√∫tiles">Otros M√©todos √ötiles</h2>
<ul>
<li><code>firstOrCreate($attributes)</code>: Obtiene el primer registro encontrado o crea uno nuevo.</li>
<li><code>findOrFail($id)</code>: Encuentra un registro por su clave primaria o falla.</li>
<li><code>whereHas('relation', $callback)</code>: Aplica condiciones a las consultas de relaciones.</li>
</ul>
<p>Este resumen proporciona una vista r√°pida de los m√©todos m√°s usados en Eloquent para realizar operaciones comunes de base de datos en Laravel. Estos m√©todos facilitan la realizaci√≥n de consultas, inserciones, actualizaciones y borrados, as√≠ como el manejo de relaciones entre modelos, de una manera m√°s legible y menos propensa a errores en comparaci√≥n con las consultas SQL crudas.</p>
<h2 id="-campos-for√°neos-y-claves-externas-en-laravel">üîó Campos for√°neos y claves externas en Laravel</h2>
<p>En migraciones de Laravel, podemos crear claves for√°neas (foreign keys) de dos formas:</p>
<ul>
<li>Usando <code>constrained()</code>:</li>
</ul>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#00688b">$table</span>-&gt;<span style="color:#658b00">foreignId</span>(<span style="color:#cd5555">&#39;specialization_id&#39;</span>)
</span></span><span style="display:flex;"><span>-&gt;<span style="color:#658b00">nullable</span>()
</span></span><span style="display:flex;"><span>-&gt;<span style="color:#658b00">constrained</span>(<span style="color:#cd5555">&#39;specializations&#39;</span>)
</span></span><span style="display:flex;"><span>-&gt;<span style="color:#658b00">onDelete</span>(<span style="color:#cd5555">&#39;cascade&#39;</span>);</span></span></code></pre></td></tr></table>
</div>
</div>
<p>‚úÖ Esto:</p>
<ul>
<li>Crea la columna <code>specialization_id</code> como nullable.</li>
<li>Crea la foreign key que referencia a <code>specializations(id)</code>.</li>
<li>Aplica &ldquo;on delete cascade&rdquo; para borrar en cascada.</li>
</ul>
<p>‚ö† <strong>Importante:</strong> el m√©todo <code>nullable()</code> debe ir <em>antes</em> de <code>constrained()</code>.<br>
Si escribes <code>-&gt;constrained()-&gt;nullable()</code>, el campo se crea como NOT NULL.</p>
<hr>
<ul>
<li>Sin usar <code>constrained()</code>:</li>
</ul>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code><span style="background-color:#d6d6c6"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid;"><code class="language-php" data-lang="php"><span style="display:flex; background-color:#d6d6c6"><span><span style="color:#00688b">$table</span>-&gt;<span style="color:#658b00">foreignId</span>(<span style="color:#cd5555">&#39;specialization_id&#39;</span>)-&gt;<span style="color:#658b00">nullable</span>();
</span></span><span style="display:flex;"><span><span style="color:#00688b">$table</span>-&gt;<span style="color:#658b00">foreign</span>(<span style="color:#cd5555">&#39;specialization_id&#39;</span>)
</span></span><span style="display:flex;"><span>-&gt;<span style="color:#658b00">references</span>(<span style="color:#cd5555">&#39;id&#39;</span>)
</span></span><span style="display:flex;"><span>-&gt;<span style="color:#658b00">on</span>(<span style="color:#cd5555">&#39;specializations&#39;</span>)
</span></span><span style="display:flex;"><span>-&gt;<span style="color:#658b00">onDelete</span>(<span style="color:#cd5555">&#39;cascade&#39;</span>);</span></span></code></pre></td></tr></table>
</div>
</div>
<p>‚úÖ Esto:</p>
<ul>
<li>Separa la definici√≥n de la columna y la clave for√°nea.</li>
<li>Permite m√°s control (por ejemplo, si usamos nombres de columnas o tablas diferentes).</li>
</ul>
<hr>
<p>‚úÖ <strong>Resumen r√°pido</strong>:</p>
<ul>
<li><code>constrained()</code> ‚Üí crea la foreign key autom√°ticamente.</li>
<li><code>nullable()</code> debe ir antes de <code>constrained()</code>.</li>
<li><code>onDelete('cascade')</code> solo funciona si existe la foreign key.</li>
<li>Si no usas <code>constrained()</code>, debes crear la foreign key manualmente con <code>foreign()</code>.</li>
</ul>
<h2 id="-cu√°ndo-pasar-el-nombre-de-la-tabla-a-constrained">üîó ¬øCu√°ndo pasar el nombre de la tabla a <code>constrained()</code>?</h2>
<ul>
<li>Si usas una clave for√°nea que sigue la convenci√≥n:
<ul>
<li>Nombre de columna: <code>specialization_id</code></li>
<li>Nombre de tabla: <code>specializations</code></li>
</ul>
</li>
</ul>
<p>Puedes usar directamente:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#00688b">$table</span>-&gt;<span style="color:#658b00">foreignId</span>(<span style="color:#cd5555">&#39;specialization_id&#39;</span>)
</span></span><span style="display:flex;"><span>-&gt;<span style="color:#658b00">nullable</span>()
</span></span><span style="display:flex;"><span>-&gt;<span style="color:#658b00">constrained</span>()
</span></span><span style="display:flex;"><span>-&gt;<span style="color:#658b00">onDelete</span>(<span style="color:#cd5555">&#39;cascade&#39;</span>);</span></span></code></pre></td></tr></table>
</div>
</div>
<p>Laravel deduce autom√°ticamente que la clave apunta a la tabla <code>specializations</code>.</p>
<hr>
<ul>
<li>Si la tabla tiene un nombre distinto, o la columna no sigue la convenci√≥n:
Debes pasar el nombre de la tabla como par√°metro:</li>
</ul>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#00688b">$table</span>-&gt;<span style="color:#658b00">foreignId</span>(<span style="color:#cd5555">&#39;spec_id&#39;</span>)
</span></span><span style="display:flex;"><span>-&gt;<span style="color:#658b00">nullable</span>()
</span></span><span style="display:flex;"><span>-&gt;<span style="color:#658b00">constrained</span>(<span style="color:#cd5555">&#39;specializations&#39;</span>)
</span></span><span style="display:flex;"><span>-&gt;<span style="color:#658b00">onDelete</span>(<span style="color:#cd5555">&#39;cascade&#39;</span>);</span></span></code></pre></td></tr></table>
</div>
</div>
<blockquote>
<p>Cuando se usa el m√©todo constrained() en Laravel, si no le pasas ning√∫n par√°metro, por defecto Laravel asume que la tabla relacionada es el plural del nombre de la columna sin el sufijo _id.</p></blockquote>
<h1 id="-relaciones-muchos-a-muchos-mn-en-laravel">üß© Relaciones muchos a muchos (M:N) en Laravel</h1>
<p>En Eloquent, las relaciones muchos a muchos permiten que los registros de un modelo est√©n relacionados con muchos registros de otro modelo, y viceversa.<br>
Por ejemplo: un usuario puede estar matriculado en varios ciclos, y un ciclo puede tener muchos usuarios.</p>
<hr>
<h2 id="-m√©todos-para-definir-relaciones-entre-modelos-en-laravel">üõ†Ô∏è M√©todos para definir relaciones entre modelos en Laravel</h2>
<p>Estos m√©todos se incluyen en los modelos:</p>
<ul>
<li>
<p><code>hasMany(Model::class, 'foreign_key')</code><br>
Relaci√≥n <strong>uno a muchos</strong>.<br>
Ejemplo: una familia tiene muchas especializaciones.</p>
</li>
<li>
<p><code>belongsTo(Model::class, 'foreign_key')</code><br>
Relaci√≥n <strong>muchos a uno</strong>.<br>
Se usa cuando el modelo actual tiene la clave for√°nea.<br>
Ejemplo: un usuario pertenece a una especializaci√≥n.</p>
</li>
<li>
<p><code>hasOne(Model::class, 'foreign_key')</code><br>
Relaci√≥n <strong>uno a uno</strong>.<br>
Se usa cuando el modelo actual NO tiene la clave for√°nea.</p>
</li>
<li>
<p><code>belongsToMany(Model::class)</code><br>
Relaci√≥n <strong>muchos a muchos</strong>, usando una tabla pivote.<br>
Ejemplo: un usuario est√° matriculado en muchos ciclos, y un ciclo tiene muchos usuarios.</p>
</li>
</ul>
<hr>
<h2 id="-c√≥mo-definir-una-relaci√≥n-muchos-a-muchos">‚úÖ C√≥mo definir una relaci√≥n muchos a muchos</h2>
<p>Se definen con <code>belongsToMany</code> en ambos modelos implicados:</p>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#228b22">// En User.php
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">function</span> <span style="color:#008b45">cycles</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#00688b">$this</span>-&gt;<span style="color:#658b00">belongsToMany</span>(Cycle::<span style="color:#658b00">class</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">// En Cycle.php
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">function</span> <span style="color:#008b45">users</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#00688b">$this</span>-&gt;<span style="color:#658b00">belongsToMany</span>(User::<span style="color:#658b00">class</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></td></tr></table>
</div>
</div>
<hr>
<h2 id="-tabla-pivote-nombre-y-convenci√≥n">üìå Tabla pivote: nombre y convenci√≥n</h2>
<p>Laravel espera que la tabla pivote se llame con los <strong>nombres de los modelos en singular y en orden alfab√©tico</strong>.<br>
Esto significa que debes tomar los nombres de los modelos, ponerlos en <strong>singular</strong>, ordenarlos <strong>alfab√©ticamente</strong> y unirlos con guion bajo (<code>_</code>).</p>
<p>üìò Por ejemplo, para los modelos <code>User</code> y <code>Cycle</code>:</p>
<ul>
<li>üî§ Orden alfab√©tico: <code>Cycle</code>, <code>User</code></li>
<li>üß© Nombre correcto de la tabla pivote: <code>cycle_user</code></li>
</ul>
<p>‚úÖ Correcto:</p>
<ul>
<li><code>cycle_user</code></li>
</ul>
<p>‚õîÔ∏è Incorrecto:</p>
<ul>
<li><code>user_cycle</code> (no respeta el orden alfab√©tico)</li>
<li><code>users_cycles</code> (en plural)</li>
<li><code>cycleusers</code> (sin guion bajo)</li>
</ul>
<p>üëâ Laravel utilizar√° este nombre por convenci√≥n si no se especifica otro en la relaci√≥n. Si tu tabla tiene un nombre diferente, deber√°s indicarlo manualmente:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#00688b">$this</span>-&gt;<span style="color:#658b00">belongsToMany</span>(Cycle::<span style="color:#658b00">class</span>, <span style="color:#cd5555">&#39;nombre_personalizado&#39;</span>);</span></span></code></pre></div>
<h2 id="-cu√°ndo-crear-la-tabla-pivote-expl√≠citamente">üß± Cu√°ndo crear la tabla pivote expl√≠citamente</h2>
<p>Debes <strong>crear manualmente la tabla pivote</strong> si:</p>
<ul>
<li>Quieres a√±adir <strong>atributos extra</strong> a la relaci√≥n (por ejemplo, <code>year</code> de matr√≠cula).</li>
<li>Quieres usar <code>withPivot()</code> para acceder a esos atributos.</li>
<li>Quieres usar un modelo intermedio (por ejemplo, <code>Enrollment</code>).</li>
</ul>
<hr>
<h2 id="-ejemplo-de-migraci√≥n-de-tabla-pivote-con-columna-extra">üìÑ Ejemplo de migraci√≥n de tabla pivote con columna extra</h2>
<div class="highlight"><div style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>Schema::<span style="color:#658b00">create</span>(<span style="color:#cd5555">&#39;cycle_user&#39;</span>, <span style="color:#8b008b;font-weight:bold">function</span> (Blueprint <span style="color:#00688b">$table</span>) {
</span></span><span style="display:flex;"><span><span style="color:#00688b">$table</span>-&gt;<span style="color:#658b00">id</span>();
</span></span><span style="display:flex;"><span><span style="color:#00688b">$table</span>-&gt;<span style="color:#658b00">foreignId</span>(<span style="color:#cd5555">&#39;user_id&#39;</span>)-&gt;<span style="color:#658b00">constrained</span>()-&gt;<span style="color:#658b00">onDelete</span>(<span style="color:#cd5555">&#39;cascade&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#00688b">$table</span>-&gt;<span style="color:#658b00">foreignId</span>(<span style="color:#cd5555">&#39;cycle_id&#39;</span>)-&gt;<span style="color:#658b00">constrained</span>()-&gt;<span style="color:#658b00">onDelete</span>(<span style="color:#cd5555">&#39;cascade&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#00688b">$table</span>-&gt;<span style="color:#658b00">year</span>(<span style="color:#cd5555">&#39;year&#39;</span>); <span style="color:#228b22">// ‚ûï Atributo adicional
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#00688b">$table</span>-&gt;<span style="color:#658b00">timestamps</span>();
</span></span><span style="display:flex;"><span>});</span></span></code></pre></td></tr></table>
</div>
</div>
<hr>
<h2 id="-acceder-a-los-campos-adicionales-de-la-tabla-pivote">üß© Acceder a los campos adicionales de la tabla pivote</h2>
<p>Usando <code>pivot</code>:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#00688b">$user</span> = User::<span style="color:#658b00">find</span>(<span style="color:#b452cd">1</span>);
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">foreach</span> (<span style="color:#00688b">$user</span>-&gt;<span style="color:#658b00">cycles</span> <span style="color:#8b008b;font-weight:bold">as</span> <span style="color:#00688b">$cycle</span>) {
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">echo</span> <span style="color:#00688b">$cycle</span>-&gt;<span style="color:#658b00">pivot</span>-&gt;<span style="color:#658b00">year</span>;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Para que funcione correctamente, debes indicarlo en el modelo:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#228b22">// En User.php
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#8b008b;font-weight:bold">public</span> <span style="color:#8b008b;font-weight:bold">function</span> <span style="color:#008b45">cycles</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#00688b">$this</span>-&gt;<span style="color:#658b00">belongsToMany</span>(Cycle::<span style="color:#658b00">class</span>)-&gt;<span style="color:#658b00">withPivot</span>(<span style="color:#cd5555">&#39;year&#39;</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<hr>
<h2 id="-diferencia-entre-hasmany-y-belongstomany">ü§î Diferencia entre <code>hasMany()</code> y <code>belongsToMany()</code></h2>
<table>
  <thead>
      <tr>
          <th>Relaci√≥n</th>
          <th>Descripci√≥n</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><code>hasMany()</code></td>
          <td>Uno a muchos. El modelo actual tiene muchos del otro modelo.</td>
      </tr>
      <tr>
          <td><code>belongsToMany()</code></td>
          <td>Muchos a muchos. Hay una <strong>tabla intermedia</strong> y la relaci√≥n va en ambos lados.</td>
      </tr>
  </tbody>
</table>
<p><strong>Ejemplo pr√°ctico</strong>:</p>
<ul>
<li>Una <strong>familia</strong> tiene muchas <strong>especializaciones</strong> ‚Üí <code>hasMany()</code></li>
<li>Un <strong>usuario</strong> est√° en muchos <strong>ciclos</strong>, y cada <strong>ciclo</strong> tiene muchos <strong>usuarios</strong> ‚Üí <code>belongsToMany()</code></li>
</ul>
<hr>
<h2 id="-resumen-visual">üß© Resumen visual</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#228b22">// Uno a muchos:
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>Family          ---&lt;     Specialization
</span></span><span style="display:flex;"><span>hasMany()             belongsTo()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">// Muchos a muchos:
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>User           &gt;---&lt;     Cycle
</span></span><span style="display:flex;"><span>belongsToMany()    belongsToMany()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">// Uno a uno:
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>User          ---       Profile
</span></span><span style="display:flex;"><span>hasOne()           belongsTo()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">## ‚úè M√©todos √∫tiles
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>
</span></span><span style="display:flex;"><span>- <span style="color:#cd5555">`attach($id, [&#39;extra&#39;])`</span>: Relaciona un registro y a√±ade datos extra.
</span></span><span style="display:flex;"><span>- <span style="color:#cd5555">`detach($id)`</span>: Quita la relaci√≥n.
</span></span><span style="display:flex;"><span>- <span style="color:#cd5555">`sync([id1, id2])`</span>: Sincroniza relaciones.
</span></span><span style="display:flex;"><span>- <span style="color:#cd5555">`updateExistingPivot($id, [&#39;extra&#39;])`</span>: Actualiza datos de la tabla pivote.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>‚úÖ **Resumen r√°pido**:
</span></span><span style="display:flex;"><span>- Relaci√≥n muchos a muchos ‚Üí <span style="color:#cd5555">`belongsToMany`</span>.
</span></span><span style="display:flex;"><span>- Tabla pivote autom√°tica (ejemplo: <span style="color:#cd5555">`cycle_user`</span>).
</span></span><span style="display:flex;"><span>- Si necesitas columnas extra ‚Üí crear migraci√≥n y (opcional) modelo Pivot.
</span></span><span style="display:flex;"><span>- Acceder a las columnas extra ‚Üí <span style="color:#cd5555">`$model-&gt;pivot-&gt;campo`</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">## üìä Tabla resumen
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>
</span></span><span style="display:flex;"><span>|                          | Sin datos extra                        | Con datos extra en pivote                |
</span></span><span style="display:flex;"><span>|------------------------|----------------------------------------|------------------------------------------|
</span></span><span style="display:flex;"><span>| Migraci√≥n              | Laravel la crea si usas <span style="color:#cd5555">`belongsToMany`</span>| Necesitas crearla manualmente            |
</span></span><span style="display:flex;"><span>| Modelo pivote          | No necesario                          | Recomendado (<span style="color:#cd5555">`CycleUser`</span>)                |
</span></span><span style="display:flex;"><span>| Acceso a datos pivote  | <span style="color:#cd5555">`$model-&gt;relation`</span>                    | <span style="color:#cd5555">`$model-&gt;relation`</span> + <span style="color:#cd5555">`$model-&gt;pivot-&gt;campo`</span> |
</span></span><span style="display:flex;"><span>| M√©todos                | <span style="color:#cd5555">`attach()`</span>, <span style="color:#cd5555">`detach()`</span>, <span style="color:#cd5555">`sync()`</span>      | Igual, pero pasando datos extra en <span style="color:#8b008b;font-weight:bold">array</span> |
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">## ‚úè Ejemplo visual
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>
</span></span><span style="display:flex;"><span>Un **usuario** puede estar matriculado en varios **ciclos**:
</span></span><span style="display:flex;"><span>- Ciclo A (a√±o <span style="color:#b452cd">2023</span>)
</span></span><span style="display:flex;"><span>- Ciclo B (a√±o <span style="color:#b452cd">2024</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>En la tabla pivote <span style="color:#cd5555">`cycle_user`</span> guardamos:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>| user_id | cycle_id | year |
</span></span><span style="display:flex;"><span>|--------|----------|------|
</span></span><span style="display:flex;"><span>| <span style="color:#b452cd">1</span>      | <span style="color:#b452cd">5</span>        | <span style="color:#b452cd">2023</span> |
</span></span><span style="display:flex;"><span>| <span style="color:#b452cd">1</span>      | <span style="color:#b452cd">6</span>        | <span style="color:#b452cd">2024</span> |
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">## üîß Ejemplo en c√≥digo
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>
</span></span><span style="display:flex;"><span><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#228b22">// Obtener los ciclos de un usuario y mostrar el a√±o de matriculaci√≥n
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#00688b">$user</span> = User::<span style="color:#658b00">find</span>(<span style="color:#b452cd">1</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">foreach</span> (<span style="color:#00688b">$user</span>-&gt;<span style="color:#658b00">cycles</span> <span style="color:#8b008b;font-weight:bold">as</span> <span style="color:#00688b">$cycle</span>) {
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">echo</span> <span style="color:#00688b">$cycle</span>-&gt;<span style="color:#658b00">name</span> . <span style="color:#cd5555">&#39; - A√±o: &#39;</span> . <span style="color:#00688b">$cycle</span>-&gt;<span style="color:#658b00">pivot</span>-&gt;<span style="color:#658b00">year</span>;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">## üìê Diagrama (en texto)
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>
</span></span><span style="display:flex;"><span><span style="color:#cd5555">```text
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">User                Cycle
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"> |                    |
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"> | &lt;--- cycle_user --&gt;|
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"> |                    |
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">## Obteniendo sentencia SQL a partir de Eloquent o Builder Class
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">En Laravel es habitual querer ver la **sentencia SQL** que genera una consulta Eloquent o un Query Builder.  
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">Ten en cuenta que `</span>toSql()<span style="color:#cd5555">` devuelve la consulta con **placeholders** (`</span>?<span style="color:#cd5555">`) ‚Äî los valores reales est√°n en `</span>getBindings()<span style="color:#cd5555">`.
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">---
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">### 1) Diferencia esencial
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">- `</span>all()<span style="color:#cd5555">` y `</span>get()<span style="color:#cd5555">` **ejecutan** la consulta y devuelven una `</span>Collection<span style="color:#cd5555">`.  
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">- `</span>toSql()<span style="color:#cd5555">` **no ejecuta** la consulta: solo funciona sobre un Query Builder y devuelve la cadena SQL con `</span>?<span style="color:#cd5555">`.
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#228b22">// Incorrecto: ya es una Collection
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>User::<span style="color:#658b00">all</span>()-&gt;<span style="color:#658b00">toSql</span>(); <span style="color:#228b22">// ‚ùå No funciona
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">// Correcto: obtenemos la SQL sin ejecutar
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>User::<span style="color:#658b00">query</span>()-&gt;<span style="color:#658b00">toSql</span>(); <span style="color:#228b22">// ‚úÖ &#34;select * from `users`&#34;
</span></span></span></code></pre></div>
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">---
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">### 2) Ejemplo con bindings (valores)
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#00688b">$query</span> = User::<span style="color:#658b00">where</span>(<span style="color:#cd5555">&#39;email&#39;</span>, <span style="color:#cd5555">&#39;like&#39;</span>, <span style="color:#cd5555">&#39;%@gmail.com%&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#00688b">$sql</span> = <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">toSql</span>();          <span style="color:#228b22">// &#34;select * from `users` where `email` like ?&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#00688b">$bindings</span> = <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">getBindings</span>(); <span style="color:#228b22">// [&#34;%@gmail.com%&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>
</span></span><span style="display:flex;"><span>dd(<span style="color:#00688b">$sql</span>, <span style="color:#00688b">$bindings</span>);</span></span></code></pre></div>
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">---
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">### 3) Ejemplo con scope (p.ej. Spatie `</span>role()<span style="color:#cd5555">`)
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">Las macros/scopes devuelven un Builder, as√≠ que `</span>toSql()<span style="color:#cd5555">` funciona:
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#228b22">// Devuelve la SQL (con subconsultas si aplica) y los bindings
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><span style="color:#00688b">$query</span> = User::<span style="color:#658b00">role</span>(<span style="color:#cd5555">&#39;student&#39;</span>);
</span></span><span style="display:flex;"><span>dd(<span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">toSql</span>(), <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">getBindings</span>());</span></span></code></pre></div>
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">---
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">### 4) Ejemplo con joins / group by / agregados
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">use</span> Illuminate\Support\Facades\DB;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00688b">$query</span> = DB::<span style="color:#658b00">table</span>(<span style="color:#cd5555">&#39;users&#39;</span>)
</span></span><span style="display:flex;"><span>    -&gt;<span style="color:#658b00">join</span>(<span style="color:#cd5555">&#39;enrollments&#39;</span>, <span style="color:#cd5555">&#39;users.id&#39;</span>, <span style="color:#cd5555">&#39;=&#39;</span>, <span style="color:#cd5555">&#39;enrollments.user_id&#39;</span>)
</span></span><span style="display:flex;"><span>    -&gt;<span style="color:#658b00">join</span>(<span style="color:#cd5555">&#39;cycles&#39;</span>, <span style="color:#cd5555">&#39;cycles.id&#39;</span>, <span style="color:#cd5555">&#39;=&#39;</span>, <span style="color:#cd5555">&#39;enrollments.cycle_id&#39;</span>)
</span></span><span style="display:flex;"><span>    -&gt;<span style="color:#658b00">select</span>(<span style="color:#cd5555">&#39;cycles.name&#39;</span>, DB::<span style="color:#658b00">raw</span>(<span style="color:#cd5555">&#39;count(users.id) as total_students&#39;</span>))
</span></span><span style="display:flex;"><span>    -&gt;<span style="color:#658b00">groupBy</span>(<span style="color:#cd5555">&#39;cycles.name&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dd(<span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">toSql</span>(), <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">getBindings</span>());</span></span></code></pre></div>
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">---
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">### 5) `</span>withCount()<span style="color:#cd5555">` y subqueries (ejemplo pr√°ctico para tus ciclos)
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">Si quieres ver la SQL generada por un `</span>withCount()<span style="color:#cd5555">` con condiciones:
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#00688b">$year</span> = <span style="color:#b452cd">2025</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00688b">$query</span> = \App\Models\Cycle::<span style="color:#658b00">withCount</span>([
</span></span><span style="display:flex;"><span>    <span style="color:#cd5555">&#39;users as students_count&#39;</span> =&gt; <span style="color:#8b008b;font-weight:bold">function</span> (<span style="color:#00688b">$q</span>) <span style="color:#8b008b;font-weight:bold">use</span> (<span style="color:#00688b">$year</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#00688b">$q</span>-&gt;<span style="color:#658b00">whereHas</span>(<span style="color:#cd5555">&#39;roles&#39;</span>, fn(<span style="color:#00688b">$r</span>) =&gt; <span style="color:#00688b">$r</span>-&gt;<span style="color:#658b00">where</span>(<span style="color:#cd5555">&#39;name&#39;</span>, <span style="color:#cd5555">&#39;student&#39;</span>))
</span></span><span style="display:flex;"><span>          -&gt;<span style="color:#658b00">wherePivot</span>(<span style="color:#cd5555">&#39;year&#39;</span>, <span style="color:#00688b">$year</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">// Ver la SQL del builder principal (incluye subqueries en SELECT)
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>dd(<span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">toSql</span>(), <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">getBindings</span>());</span></span></code></pre></div>
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">---
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">### 6) Ver la SQL con los valores interpolados (para depuraci√≥n)
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">Laravel devuelve `</span>?<span style="color:#cd5555">` en la SQL; para ver la consulta con los valores insertados puedes interpolarlos **con cuidado**:
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">#### Opci√≥n A ‚Äî helper `</span>str_replace_array<span style="color:#cd5555">` (Laravel)
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#00688b">$sqlWithBindings</span> = str_replace_array(<span style="color:#cd5555">&#39;?&#39;</span>, <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">getBindings</span>(), <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">toSql</span>());
</span></span><span style="display:flex;"><span>dd(<span style="color:#00688b">$sqlWithBindings</span>);</span></span></code></pre></div>
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">&gt; ‚ö†Ô∏è `</span>str_replace_array<span style="color:#cd5555">` reemplaza `</span>?<span style="color:#cd5555">` por los bindings en orden. Si los bindings requieren comillas o escape, tendr√°s que a√±adirlas.
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">#### Opci√≥n B ‚Äî funci√≥n segura usando reemplazos uno a uno
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">function</span> <span style="color:#008b45">interpolateQuery</span>(<span style="color:#00688b">$query</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#00688b">$sql</span> = <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">toSql</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">foreach</span> (<span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">getBindings</span>() <span style="color:#8b008b;font-weight:bold">as</span> <span style="color:#00688b">$binding</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#00688b">$value</span> = is_numeric(<span style="color:#00688b">$binding</span>) ? <span style="color:#00688b">$binding</span> : <span style="color:#cd5555">&#34;&#39;&#34;</span>.addslashes(<span style="color:#00688b">$binding</span>).<span style="color:#cd5555">&#34;&#39;&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#00688b">$sql</span> = preg_replace(<span style="color:#cd5555">&#39;/\?/&#39;</span>, <span style="color:#00688b">$value</span>, <span style="color:#00688b">$sql</span>, <span style="color:#b452cd">1</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#8b008b;font-weight:bold">return</span> <span style="color:#00688b">$sql</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00688b">$prettySql</span> = interpolateQuery(<span style="color:#00688b">$query</span>);
</span></span><span style="display:flex;"><span>dd(<span style="color:#00688b">$prettySql</span>);</span></span></code></pre></div>
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">&gt; Nota: esto es para depuraci√≥n. No uses interpolaci√≥n para ejecutar consultas (riesgo SQL injection si manipulas manualmente).
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">---
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">### 7) Escuchar y registrar todas las consultas (√∫til en runtime)
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">#### Usando `</span>DB::<span style="color:#658b00">listen</span>()<span style="color:#cd5555">` ‚Äî ideal para logging o debugging en runtime:
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>\DB::<span style="color:#658b00">listen</span>(<span style="color:#8b008b;font-weight:bold">function</span> (<span style="color:#00688b">$query</span>) {
</span></span><span style="display:flex;"><span>    \Log::<span style="color:#658b00">info</span>(<span style="color:#cd5555">&#39;SQL: &#39;</span>.<span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">sql</span>, <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">bindings</span>);
</span></span><span style="display:flex;"><span>});</span></span></code></pre></div>
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">#### Usando Query Log temporal:
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>\DB::<span style="color:#658b00">enableQueryLog</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#228b22">// Ejecuta tus consultas aqu√≠
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>User::<span style="color:#658b00">role</span>(<span style="color:#cd5555">&#39;student&#39;</span>)-&gt;<span style="color:#658b00">get</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00688b">$log</span> = \DB::<span style="color:#658b00">getQueryLog</span>();
</span></span><span style="display:flex;"><span>dd(<span style="color:#00688b">$log</span>);</span></span></code></pre></div>
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">---
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">### 8) Ejemplos en Tinker
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#228b22"># En Tinker
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>&gt;&gt;&gt; User::<span style="color:#658b00">query</span>()-&gt;<span style="color:#658b00">toSql</span>();
</span></span><span style="display:flex;"><span>=&gt; <span style="color:#cd5555">&#34;select * from `users`&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;&gt; <span style="color:#00688b">$q</span> = User::<span style="color:#658b00">where</span>(<span style="color:#cd5555">&#39;id&#39;</span>, <span style="color:#cd5555">&#39;&gt;&#39;</span>, <span style="color:#b452cd">10</span>);
</span></span><span style="display:flex;"><span>&gt;&gt;&gt; <span style="color:#00688b">$q</span>-&gt;<span style="color:#658b00">toSql</span>();
</span></span><span style="display:flex;"><span>=&gt; <span style="color:#cd5555">&#34;select * from `users` where `id` &gt; ?&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;&gt; <span style="color:#00688b">$q</span>-&gt;<span style="color:#658b00">getBindings</span>();
</span></span><span style="display:flex;"><span>=&gt; [<span style="color:#b452cd">10</span>]</span></span></code></pre></div>
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">---
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">### 9) Consejos y buenas pr√°cticas
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">- Usa `</span>toSql()<span style="color:#cd5555">` **antes** de ejecutar la consulta.  
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">- Para ver valores reales, combina `</span>toSql()<span style="color:#cd5555">` + `</span>getBindings()<span style="color:#cd5555">` o usa una funci√≥n de interpolaci√≥n solo para **depuraci√≥n**.  
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">- Para debugging en desarrollo, `</span>DB::<span style="color:#658b00">listen</span>()<span style="color:#cd5555">` o Laravel Telescope/Debugbar son soluciones m√°s potentes.  
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">- Evita interpolar manualmente consultas para volver a ejecutarlas (riesgo de seguridad).  
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">- `</span>toSql()<span style="color:#cd5555">` no muestra cambios hechos por middlewares o por el driver (p.ej. fechas autom√°ticas), pero es suficiente para entender la estructura de la consulta generada por Eloquent/Builder.
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">---
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">### Ejemplos
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">#### Usando Query Builder
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#00688b">$query</span> = DB::<span style="color:#658b00">table</span>(<span style="color:#cd5555">&#39;users&#39;</span>)-&gt;<span style="color:#658b00">where</span>(<span style="color:#cd5555">&#39;active&#39;</span>, <span style="color:#b452cd">1</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00688b">$sql</span> = <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">toSql</span>(); 
</span></span><span style="display:flex;"><span><span style="color:#228b22">// SELECT * FROM `users` WHERE `active` = ?
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>
</span></span><span style="display:flex;"><span><span style="color:#00688b">$bindings</span> = <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">getBindings</span>(); 
</span></span><span style="display:flex;"><span><span style="color:#228b22">// [1]
</span></span></span></code></pre></div>
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">#### Usando Eloquent
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#00688b">$query</span> = User::<span style="color:#658b00">where</span>(<span style="color:#cd5555">&#39;active&#39;</span>, <span style="color:#b452cd">1</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00688b">$sql</span> = <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">toSql</span>(); 
</span></span><span style="display:flex;"><span><span style="color:#228b22">// SELECT * FROM `users` WHERE `active` = ?
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span>
</span></span><span style="display:flex;"><span><span style="color:#00688b">$bindings</span> = <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">getBindings</span>(); 
</span></span><span style="display:flex;"><span><span style="color:#228b22">// [1]
</span></span></span></code></pre></div>
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">#### Convertir a SQL + valores enlazados (debug r√°pido)
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">Puedes combinar `</span>toSql()<span style="color:#cd5555">` y `</span>getBindings()<span style="color:#cd5555">` para imprimir la consulta completa:
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555"><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#00688b">$query</span> = User::<span style="color:#658b00">where</span>(<span style="color:#cd5555">&#39;active&#39;</span>, <span style="color:#b452cd">1</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00688b">$sql</span> = vsprintf(str_replace(<span style="color:#cd5555">&#39;?&#39;</span>, <span style="color:#cd5555">&#34;&#39;%s&#39;&#34;</span>, <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">toSql</span>()), <span style="color:#00688b">$query</span>-&gt;<span style="color:#658b00">getBindings</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">echo</span> <span style="color:#00688b">$sql</span>;
</span></span><span style="display:flex;"><span><span style="color:#228b22">// SELECT * FROM `users` WHERE `active` = &#39;1&#39;
</span></span></span></code></pre></div>
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">#### Por qu√© `</span>User::<span style="color:#658b00">all</span>()-&gt;<span style="color:#658b00">toSql</span>()<span style="color:#cd5555">` no funciona
</span></span></span><span style="display:flex;"><span><span style="color:#cd5555">El m√©todo `</span>all()<span style="color:#a61717;background-color:#e3d2d2">`</span> ejecuta la consulta inmediatamente y devuelve una colecci√≥n de resultados, por lo que ya no es una instancia de *builder*.  
</span></span><span style="display:flex;"><span>Para obtener la SQL antes de ejecutar, usa:
</span></span><span style="display:flex;"><span><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>User::<span style="color:#658b00">query</span>()-&gt;<span style="color:#658b00">toSql</span>();</span></span></code></pre></div>
</span></span><span style="display:flex;"><span>o bien:
</span></span><span style="display:flex;"><span><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>User::<span style="color:#658b00">select</span>(<span style="color:#cd5555">&#39;*&#39;</span>)-&gt;<span style="color:#658b00">toSql</span>();</span></span></code></pre></div>
</span></span><span style="display:flex;"><span><span style="color:#228b22">### One-liner para ver SQL de cualquier consulta Eloquent
</span></span></span><span style="display:flex;"><span><span style="color:#228b22"></span><div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span>dd(User::<span style="color:#658b00">where</span>(<span style="color:#cd5555">&#39;active&#39;</span>, <span style="color:#b452cd">1</span>)-&gt;<span style="color:#658b00">toSql</span>(), User::<span style="color:#658b00">where</span>(<span style="color:#cd5555">&#39;active&#39;</span>, <span style="color:#b452cd">1</span>)-&gt;<span style="color:#658b00">getBindings</span>());</span></span></code></pre></div>
</span></span></code></pre></div>
	
</div>


          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="td-footer__left col-6 col-sm-4 order-sm-1">
        <ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="Correo del usuario" aria-label="Correo del usuario">
    <a target="_blank" rel="noopener" href="https://example.org/mail" aria-label="Correo del usuario">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/MAlejandroR" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

      </div><div class="td-footer__right col-6 col-sm-4 order-sm-3">
        
      </div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2">
        <span class="td-footer__copyright">&copy;
    2026
    <span class="td-footer__authors">@MRomero</span></span><span class="td-footer__all_rights_reserved">Derechos reservados</span><span class="ms-2"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener">Pol√≠tica de privacidad</a></span>
      </div>
    </div>
  </div>
</footer>

    </div>
    <style>
.markmap > svg {
  width: 100%;
  height: 300px;
}
</style>
<script>
window.markmap = {
  autoLoader: {
      manual: true,
      onReady() {
        const { autoLoader, builtInPlugins } = window.markmap;
        autoLoader.transformPlugins = builtInPlugins.filter(plugin => plugin.name !== 'prism');
      },
  },
};
</script>
<script src="https://cdn.jsdelivr.net/npm/markmap-autoloader"></script>
<script src="/laravel/js/main.min.6eb0b9973712a5097eb2eed7270caf210eef4a627ea63b065e308df139220920.js" integrity="sha256-brC5lzcSpQl&#43;su7XJwyvIQ7vSmJ&#43;pjsGXjCN8TkiCSA=" crossorigin="anonymous"></script>
<script defer src="/laravel/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js" integrity="sha256-c0eKfUgHaYrtfjVesj&#43;YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin="anonymous"></script>
<script src='/laravel/js/tabpane-persist.js'></script>

  </body>
</html>